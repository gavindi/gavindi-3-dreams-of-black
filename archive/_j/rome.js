/**
 * @author jonobr1 http://jonobr1.com/
 */

var red="#D42427",white="#fff",black="#000";var svgs={};var pre="_s/",suf=".svg";var names=["heart","reflection","drip0","drip1","drip2","drip3","title","heartless","billboard","credits"];var drips=[];drips.count=4;drips.args=[{x:-98,y:9,h:120,t:12000,b:false},{x:-45,y:41,h:100,t:15000,b:false},{x:-21,y:59,h:110,t:10000,b:false},{x:-2,y:-27,h:50,t:6000,b:true}];var title=[];var bill=[];var cred=[];var heart=[];bill.val=0;cred.val=0;heart.val=0;var animateDrips=false,animateCred=false;var animateTitle=false;title.val=0;title.t=2500;var isTitleAnimating=false;var isCredAnimating=false;var isBillAnimating=false;var dripAlpha=0;var tweenTitle,tweenBill,tweenHeart,tweenCred;var scroll;var checkAsset=0;function setup(){size(792,1324);frameRate=60;g.clearRect(0,0,width,height);for(var a=0;a<names.length;a++){try{loadSVG(pre+names[a]+suf,loadAsset)}catch(b){document.write("Unable to load "+filename+". Is "+b+" by your browser.")}}for(var a=0;a<drips.count;a++){drips[a]=new Drip();drips[a].setup(drips.args[a].x,drips.args[a].y,drips.args[a].h,names[a+2],drips.args[a].t,drips.args[a].b)}tweenBill=new TWEEN.Tween(bill).to({val:1},title.t).easing(TWEEN.Easing.Linear.EaseNone);tweenHeart=new TWEEN.Tween(heart).to({val:1},title.t*0.9).easing(TWEEN.Easing.Linear.EaseNone);tweenTitle=new TWEEN.Tween(title).to({val:1},title.t*0.9).easing(TWEEN.Easing.Linear.EaseNone);tweenCred=new TWEEN.Tween(cred).to({val:1},title.t).easing(TWEEN.Easing.Linear.EaseNone);tweenBill.chain(tweenHeart);tweenHeart.onComplete(function(){animateDrips=true;dripAlpha=1});tweenTitle.onComplete(function(){animateCred=true;var c=jQuery("html").height();scroll=jQuery("html, body").delay(1250).animate({scrollTop:c},28750,"linear")});tweenCred.onComplete(function(){clearInterval(iterate)});jQuery(window).mousedown(function(){mouseWheelScroll()});jQuery(window).keydown(function(){mouseWheelScroll()});if(window.addEventListener){document.addEventListener("DOMMouseScroll",mouseWheelScroll,false)}document.onmousewheel=mouseWheelScroll}function mouseWheelScroll(){if(animateCred){jQuery("html, body").stop(true,false)}}function draw(){TWEEN.update();g.clearRect(0,0,width,height);if(checkAsset>=names.length){g.save();g.translate(width/2,height/2-143);g.globalAlpha=heart.val;g.save();g.translate(-svgs.heart.width/2+2,-svgs.heart.height/2-1);svgs.heart.draw(g);g.restore();g.globalAlpha=dripAlpha;for(var a=0;a<drips.count;a++){if(animateDrips&&!drips[a].isAnimating){drips[a].tween.start();drips[a].isAnimating=true}drips[drips.count-a-1].render()}g.save();g.translate(-svgs.heartless.width/2+2,-svgs.heartless.height/2-3);svgs.heartless.draw(g);g.restore();if(heart.val>0){g.globalAlpha=1;g.save();g.translate(-svgs.reflection.width/2,-svgs.reflection.height/2);svgs.reflection.draw(g);g.restore()}if(animateTitle&&!isTitleAnimating){tweenTitle.start();isTitleAnimating=true}g.save();g.translate(-197,-289);g.globalAlpha=title.val;svgs.title.draw(g);g.restore();if(!isBillAnimating){tweenBill.start();isBillAnimating=true}g.save();g.globalAlpha=bill.val;g.translate(-318,-478);svgs.billboard.draw(g);g.restore();if(animateCred&&!isCredAnimating){tweenCred.start();isCredAnimating=true}g.save();g.globalAlpha=cred.val;g.translate(-354,367);svgs.credits.draw(g);g.restore();g.restore()}}function loadAsset(b,a){var c=a.replace(pre,"");c=c.replace(suf,"");svgs[c]=b;checkAsset++}function Drip(){this.p;this.a;this.t;this.b;this.name;this.tween;this.isAnimating=false;this.setup=function(c,a,f,d,e,b){this.p={x:c,y:a-f};this.a=a;this.t=e;this.b=b;this.name=d;this.tween=new TWEEN.Tween(this.p).to({y:this.a},this.t).easing(TWEEN.Easing.Exponential.EaseOut);if(this.b){this.tween.onComplete(function(){animateTitle=true})}};this.render=function(){g.save();g.translate(this.p.x,this.p.y);svgs[this.name].draw(g);g.restore()}};